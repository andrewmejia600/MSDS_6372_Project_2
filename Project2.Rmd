---
title: "DS6372_Project2"
author: "AndrewMejia"
date: "3/15/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


```{r}

library(ggplot2)
library(GGally)
library(dplyr)

Bank_mrkt_data  = read.csv(file.choose(),header = TRUE, sep = ';')

#Looking for complete records
Bank_mrkt_data %>% filter(complete.cases(Bank_mrkt_data))

#Looking for incomplete records 
Bank_mrkt_data %>% filter(!complete.cases(Bank_mrkt_data))

summary(Bank_mrkt_data)

#unknown records 

dim(Bank_mrkt_data %>% filter(grepl("unknown", Bank_mrkt_data$education)==TRUE))[1]
dim(Bank_mrkt_data %>% filter(grepl("unknown", Bank_mrkt_data$job)==TRUE))[1]




plot(Bank_mrkt_data[,1:3], col = Bank_mrkt_data$y)
plot(Bank_mrkt_data[,4:7], col = Bank_mrkt_data$y)
plot(Bank_mrkt_data[,8:11], col = Bank_mrkt_data$y)
plot(Bank_mrkt_data[,12:15], col = Bank_mrkt_data$y)
plot(Bank_mrkt_data[,16:20], col = Bank_mrkt_data$y)

#need to make scatter plots based on differences in response variables of colors see HW for LDA     
#We can see there is a disporationate amount of nos to yes records
ggpairs(Bank_mrkt_data[,c(21, 1:3)], ggplot2::aes(colour=y))

ggpairs(Bank_mrkt_data[,c(21, 4:7)],  ggplot2::aes(colour=y))

ggpairs(Bank_mrkt_data[,c(21, 8:11)],  ggplot2::aes(colour=y))

ggpairs(Bank_mrkt_data[,c(21, 12:15)],  ggplot2::aes(colour=y))

ggpairs(Bank_mrkt_data[,c(21, 16:20)],  ggplot2::aes(colour=y))




Bank_mrkt_data %>% ggplot(aes(x = marital, y = age , color = y)) + geom_point()

Bank_mrkt_data %>% ggplot(aes(x = marital, y = age , color = y)) + geom_boxplot()

Bank_mrkt_data %>% ggplot(aes(x = job, y = age , color = y)) + geom_boxplot()

Bank_mrkt_data %>% ggplot(aes(x = marital, y = age , color = y)) + geom_col()



#see a limited seperation of duration and month 
Bank_mrkt_data %>% ggplot(aes(x = duration, y = month , color = y)) + geom_point()

Bank_mrkt_data %>% ggplot(aes(x = duration, y = month , color = y)) + geom_point()


#See a clear seperation between duration and age 
Bank_mrkt_data %>% ggplot(aes(x = age, y = duration , color = y)) + geom_point()

# see a clear seperation between duration and campaingn
Bank_mrkt_data %>% ggplot(aes(x = duration, y = campaign , color = y)) + geom_point()

Bank_mrkt_data %>% ggplot(aes(x = previous, y = campaign , color = y)) + geom_point()

#Star to see a clear seperation between nr. employed and cons.price.idx   
Bank_mrkt_data %>% ggplot(aes(x = nr.employed, y = cons.price.idx , color = y)) + geom_boxplot()

Bank_mrkt_data %>% ggplot(aes(x = job, y = cons.price.idx , color = y)) + geom_boxplot()

Bank_mrkt_data %>% ggplot(aes(x = nr.employed, y = cons.conf.idx , color = y)) + geom_boxplot()

  






```

```{r}
library(MASS)
library(stringr)

colname_vec = str_replace_all(toString(names(Bank_mrkt_data)[1:20]),"\\,", "\\ +")

lda_analysis = lda(y ~ age + job + marital + education + default + housing + loan + contact + month + day_of_week + duration + campaign + pdays + previous + poutcome + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + nr.employed, data = Bank_mrkt_data)

```